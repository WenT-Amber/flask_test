<!DOCTYPE html>
<html>
<head>
    <title></title>
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

    <script type="text/javascript">
        function check(){
            var check=$("input[name='test_Suite']:checked").length;//判斷PC登入 一定要勾選
            var driver_check = $('#Pc_driver').children(':checkbox').length;
            //console.log(driver_check)
            //console.log(check)
                if(check==0){
                    alert("你未勾選任何項目");
                    return false;//不要提交表單
                }
                else if(check>13){
                    alert("PC自動化案例,不建議和街口案例一起, 抱歉");
                    $('#Pc_driver').children(':checkbox').prop('checked',$(this).is(':checked')?true:false);
                    //return false;//不要提交表單
                }
                else if($('#username').val()=='') {
                    alert('請輸入用戶名')
                }
                else if(driver_check>3){
                    alert('PC自動化案例暫停開放謝謝')
                }
                else{
                    $.ajax({url:"/autoTest",
                    type:'POST',
                    headers:{
                        Accept:"application/json; charset=utf-8"
                    },
                    data: $('#form1').serialize(),
                    success:function(data){
                        
                        //console.log(data)
                    if (data=='此環境沒有該用戶'){
                    alert('此環境沒有該用戶')
                    location.reload();
                    }
                    else{
                        $(window).attr("location","/report")
                    }
                    } 
                    })
                    }
                /*
                event.preventDefault();
                var source = new EventSource("/progress");
                //var msg = 'start'
                source.onmessage = function (event) {
                //console.log(data)
                $('.progress-bar').css('width', event.data + '%').attr('aria-valuenow', event.data);
                $('.progress-bar-label').text(event.data + '%');  
                }  */
                    //source.close()
                    }
                
        
    </script>

    <script>
        $(document).ready(function(){
        //checkbox全選功能 , PC,APP, driver
        $('#PcChecked').change(function(){//PC接口全選
        $('#Pc_login').children(':checkbox').prop('checked',$(this).is(':checked')?true:false);
        });
        $('#AppChecked').change(function(){//APP接口全選
        $('#App_login').children(':checkbox').prop('checked',$(this).is(':checked')?true:false);
        });
        $('#DriverChecked').change(function(){//Pc自動化全選
        $('#Pc_driver').children(':checkbox').prop('checked',$(this).is(':checked')?true:false);
        
        });
        $("input[id^='test_App']").change(function(){// 讓 APP登入為必要勾選, 只要勾了 子項目,必勾登入
        $('#test_AppLogin').prop('checked',$(this).is(':checked')?true:false);
        var check=$("input[id='test_AppLogin']:checked").length; //判斷APP登入長度, 如果長度為0, 其他子項目 必為空
        if(check==0){
            $("input[id^='test_App']").prop('checked',$(this).is(':checked')?true:false);
        }
        });
        $("input[id^='test_Pc']").change(function(){//PC 子項目勾選後, 登入 會跟著一起勾, 
        $('#test_PcLogin').prop('checked',$(this).is(':checked')?true:false);
        var check=$("input[id='test_PcLogin']:checked").length;//PC登入長度, 長度0 ,子項目必為空
        if (check==0){
            $("input[id^='test_Pc']").prop('checked',$(this).is(':checked')?true:false);
        }
        });
        $("#AllChecked").change(function(){// 全部  ,讓全部案例勾選
        $("input[id^='test_']").prop('checked',$(this).is(':checked')?true:false);
    });
    });
    </script>
</head>
<style>
    input[type="checkbox"]{zoom:150%;cursor:pointer;vertical-align:sub;}
    li{list-style: none;}
</style>
<body>
    <h1>測試案例</h1>
<form id='form1' method='POST'>
    請輸入用戶名<input type='text' name='username' id=username size=16>
    <label>環境: </label>
    <select name='env_type' id='env_type'>
        <option value="dev02">dev02</option>
        <option value="joy188" selected>joy188</option>
    </select>
    <br></br>
    <input type='checkbox' id='PcChecked'>PC接口測試
    <div id ='Pc_login'>
    <input type ="checkbox" name="test_Suite" id="test_PcLogin"value="test_PcLogin" >登入測試
    <input type ="checkbox" name="test_Suite"id="test_PcThirdHome"value="test_PcThirdHome">第三方頁面測試
    <input type ="checkbox" name="test_Suite" id="test_PcFFHome"value="test_PcFFHome">4.0頁面測試
    <input type ="checkbox" name="test_Suite" id="test_PcChart"value="test_PcChart">走勢圖測試
    <input type ="checkbox" name="test_Suite" id="test_PcThirdBalance"value="test_PcThirdBalance">4.0/第三方餘額測試
    <input type ="checkbox" name="test_Suite" id="test_PcTransferin"value="test_PcTransferin">第三方轉入測試
    <input type ="checkbox" name="test_Suite" id="test_PcTransferout"value="test_PcTransferout">第三方轉出測試
    </div>
    <br></br>
    <input type='checkbox' id='AppChecked'>APP接口測試
    <div id='App_login'>
    <input type ="checkbox" name="test_Suite" id="test_AppLogin" value="test_AppLogin">登入測試
    <input type ="checkbox" name="test_Suite" id="test_AppSubmit" value="test_AppSubmit">投注測試
    <input type ="checkbox" name="test_Suite" id="test_AppOpenLink" value="test_AppOpenLink">開戶/註冊測試
    <input type ="checkbox" name="test_Suite" id="test_AppBalance" value="test_AppBalance">4.0/第三方餘額測試
    <input type ="checkbox" name="test_Suite" id="test_ApptransferIn" value="test_ApptransferIn">第三方轉入測試
    <input type ="checkbox" name="test_Suite" id="test_ApptransferOut" value="test_ApptransferOut">第三方轉出測試

    </div>
    
    <br></br>
    <input type='checkbox' id='DriverChecked'>PC自動化測試
    <div id='Pc_driver' >
    <input type ="checkbox" name="test_Suite" id= "safepersonal" value="test_safepersonal">修改登入密碼測試
    <input type ="checkbox" name="test_Suite" id="applycenter" value="test_applycenter">
    開戶注測/設置安全中心/銀行綁定 測試
    <input type ="checkbox" name="test_Suite" id="mul_lottery" value="test_plan">彩種追號案例
    </div>
    <input type='checkbox' id='AllChecked' style="display:none;">
    <p><input type="button" onclick="check()" value="执行"></p>
</form>
<h3>進度條顯示</h3>
<div class="progress" style="width: 750px;height: 22px; margin: 10px;">
    <div class="progress-bar progress-bar-striped progresslabel-bar-animated" role="progressbar" aria-valuenow="0"
         aria-valuemin="0" aria-valuemax="100" style="width: 0%">
        <span class="progress-bar-label">0%</span>
    </div>
</div>
</body>
</html> 